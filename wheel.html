<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wheel Of Choices</title>
  <link rel="stylesheet" href="style.css">
  <link rel="shortcut icon" href="WHEEL IMG.png">
</head>
<body>
  <h1>ðŸŽ¡ Spin the wheel ðŸŽ‰</h1>

  <div class="setup">
    <label>Number of Slices:</label>
    <input type="number" id="sliceCount" value="6" min="2" />
    <label>Enter Words or Numbers (comma separated):</label>
    <textarea id="optionsInput" rows="3" placeholder="e.g. Pizza, Burger, Pasta, Tacos"></textarea>
    <button onclick="generateWheel()">Generate Wheel</button>
    <button onclick="spinWheel()">SPIN</button>
  </div>

  <div class="wheel-container">
    <div class="indicator"></div>
    <canvas id="wheel"></canvas>
  </div>

  <div class="result" id="result"></div>

  <script>
    const canvas = document.getElementById("wheel");
    const ctx = canvas.getContext("2d");
    canvas.width = 500;
    canvas.height = 500;
    let options = ["One", "Two", "Three", "Four", "Five", "Six"];
    let startAngle = 0;
    let spinTime = 0;
    let spinTimeTotal = 0;
    let isSpinning = false;

    function drawWheel() {
      const outsideRadius = 230;
      const textRadius = 180;
      const insideRadius = 30;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const arc = Math.PI * 2 / options.length;
      ctx.strokeStyle = "#222";
      ctx.lineWidth = 2;
      ctx.font = "bold 18px Poppins";

      for (let i = 0; i < options.length; i++) {
        const angle = startAngle + i * arc;
        ctx.fillStyle = `hsl(${(i * 360) / options.length}, 80%, 55%)`;
        ctx.beginPath();
        ctx.arc(250, 250, outsideRadius, angle, angle + arc, false);
        ctx.arc(250, 250, insideRadius, angle + arc, angle, true);
        ctx.fill();
        ctx.save();
        ctx.fillStyle = "white";
        ctx.translate(
          250 + Math.cos(angle + arc / 2) * textRadius,
          250 + Math.sin(angle + arc / 2) * textRadius
        );
        ctx.rotate(angle + arc / 2);
        const text = options[i];
        ctx.fillText(text, -ctx.measureText(text).width / 2, 0);
        ctx.restore();
      }
    }

    function generateWheel() {
      const sliceCount = parseInt(document.getElementById("sliceCount").value);
      const rawInput = document.getElementById("optionsInput").value.trim();
      let inputArray = rawInput ? rawInput.split(",").map(v => v.trim()) : [];

      // Fill or trim to match slice count
      if (inputArray.length < sliceCount) {
        for (let i = inputArray.length; i < sliceCount; i++) {
          inputArray.push(`Option ${i + 1}`);
        }
      } else if (inputArray.length > sliceCount) {
        inputArray = inputArray.slice(0, sliceCount);
      }

      options = inputArray;
      drawWheel();
      document.getElementById("result").innerText = "";
    }

    function spinWheel() {
      if (isSpinning || options.length === 0) return;
      isSpinning = true;
      spinTime = 0;
      spinTimeTotal = 4000 + Math.random() * 3000;
      rotateWheel();
    }

    function rotateWheel() {
      spinTime += 30;
      if (spinTime >= spinTimeTotal) {
        stopRotateWheel();
        return;
      }
      const spinAngle = easeOut(spinTime, 0.4 * Math.PI, 0, spinTimeTotal);
      startAngle += spinAngle;
      drawWheel();
      requestAnimationFrame(rotateWheel);
    }

    function stopRotateWheel() {
      const degrees = (startAngle * 180 / Math.PI + 90) % 360;
      const arcd = 360 / options.length;
      const index = Math.floor((360 - degrees) / arcd) % options.length;
      const resultText = options[index];
      document.getElementById("result").innerHTML = `ðŸŽ‰ Result: <span style="color:#ffb100">${resultText}</span>`;
      confetti();
      isSpinning = false;
    }

    function easeOut(t, b, c, d) {
      const ts = (t /= d) * t;
      const tc = ts * t;
      return b * (tc + -3 * ts + 3 * t);
    }

    function confetti() {
      for (let i = 0; i < 50; i++) {
        const div = document.createElement("div");
        div.classList.add("confetti");
        div.style.setProperty("--x", Math.random() * 100 + "%");
        div.style.setProperty("--color", `hsl(${Math.random() * 360}, 100%, 60%)`);
        document.body.appendChild(div);
        setTimeout(() => div.remove(), 2000);
      }
    }

    drawWheel();
  </script>
</body>
</html>
